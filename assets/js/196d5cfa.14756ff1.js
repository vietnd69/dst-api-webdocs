"use strict";(self.webpackChunkdst_api_webdocs=self.webpackChunkdst_api_webdocs||[]).push([[6500],{4169:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"api-vanilla/node-types/component","title":"Component","description":"Last Update: 2023-07-06","source":"@site/docs/api-vanilla/node-types/component.md","sourceDirName":"api-vanilla/node-types","slug":"/api-vanilla/node-types/component","permalink":"/dst-api-webdocs/docs/api-vanilla/node-types/component","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"component","title":"Component","sidebar_position":3,"last_updated":"2023-07-06T00:00:00.000Z"}}');var o=t(4848),i=t(8453);const l={id:"component",title:"Component",sidebar_position:3,last_updated:new Date("2023-07-06T00:00:00.000Z")},a="Component",r={},d=[{value:"Overview",id:"overview",level:2},{value:"Component Structure",id:"component-structure",level:2},{value:"Component Lifecycle",id:"component-lifecycle",level:2},{value:"Adding Components to Entities",id:"adding-components-to-entities",level:2},{value:"Common Components",id:"common-components",level:2},{value:"Component Replication",id:"component-replication",level:2},{value:"Related Systems",id:"related-systems",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Last Update: 2023-07-06"})}),"\n",(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"component",children:"Component"})}),"\n",(0,o.jsx)(n.p,{children:"Components are functional modules attached to entities to provide specific behaviors and properties."}),"\n",(0,o.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(n.p,{children:"The component system is a key part of Don't Starve Together's entity-component architecture. Components encapsulate specific functionality that can be added to entities, making them modular and reusable. Each component handles a specific aspect of an entity's behavior or properties."}),"\n",(0,o.jsx)(n.h2,{id:"component-structure",children:"Component Structure"}),"\n",(0,o.jsx)(n.p,{children:"A typical component has this structure:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-lua",children:'local MyComponent = Class(function(self, inst)\n    self.inst = inst\n    self.value = 100\n    self.enabled = true\nend)\n\nfunction MyComponent:OnSave()\n    return {\n        value = self.value,\n        enabled = self.enabled\n    }\nend\n\nfunction MyComponent:OnLoad(data)\n    self.value = data.value or self.value\n    self.enabled = data.enabled or self.enabled\nend\n\nfunction MyComponent:GetDebugString()\n    return string.format("Value: %d, Enabled: %s", self.value, tostring(self.enabled))\nend\n\nfunction MyComponent:DoSomething(amount)\n    if self.enabled then\n        self.value = self.value + amount\n        self.inst:PushEvent("valueupdated", {value = self.value})\n    end\nend\n\nreturn MyComponent\n'})}),"\n",(0,o.jsx)(n.h2,{id:"component-lifecycle",children:"Component Lifecycle"}),"\n",(0,o.jsx)(n.p,{children:"Components have several lifecycle methods:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Constructor"}),": Called when the component is created"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"OnRemoveFromEntity"}),": Called when the component is removed"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"OnSave"}),": Called when the game is saving"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"OnLoad"}),": Called when the game is loading"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"GetDebugString"}),": Called when debugging information is requested"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"adding-components-to-entities",children:"Adding Components to Entities"}),"\n",(0,o.jsx)(n.p,{children:"Components are added to entities like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-lua",children:'entity:AddComponent("health")\nentity.components.health:SetMaxHealth(100)\n\n-- Check if entity has a component\nif entity.components.combat then\n    entity.components.combat:SetDefaultDamage(10)\nend\n\n-- Remove a component\nentity:RemoveComponent("burnable")\n'})}),"\n",(0,o.jsx)(n.h2,{id:"common-components",children:"Common Components"}),"\n",(0,o.jsx)(n.p,{children:"Here are some important components in Don't Starve Together:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"health"}),": Handles entity health and damage"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"hunger"}),": Manages hunger for characters"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"sanity"}),": Controls sanity level for characters"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"inventory"}),": Manages item storage"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"combat"}),": Handles attacking and combat"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"lootdropper"}),": Determines what items an entity drops when killed"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"inspectable"}),": Allows an entity to be inspected"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"workable"}),": Makes an entity workable with tools"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"burnable"}),": Makes an entity able to burn"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"propagator"}),": Allows an entity to spread fire"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"stewer"}),": For cooking food items"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"growable"}),": For things that grow over time"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"trader"}),": For entities that can trade"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"locomotor"}),": Handles movement"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"component-replication",children:"Component Replication"}),"\n",(0,o.jsx)(n.p,{children:"For multiplayer, components need to replicate their state between server and clients:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-lua",children:'-- In component initialization\nif TheWorld.ismastersim then\n    -- Server-only initialization\n    self.netvar = net_bool(self.inst.GUID, "mycomponent.value", "valuedirty")\nend\n\n-- Server setting a value\nfunction MyComponent:SetValue(val)\n    self.value = val\n    self.netvar:set(val)\nend\n\n-- Client listening for changes\nif not TheWorld.ismastersim then\n    inst:ListenForEvent("valuedirty", OnValueChanged)\nend\n'})}),"\n",(0,o.jsx)(n.h2,{id:"related-systems",children:"Related Systems"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Entity system"}),"\n",(0,o.jsx)(n.li,{children:"Network replication"}),"\n",(0,o.jsx)(n.li,{children:"Event system"}),"\n",(0,o.jsx)(n.li,{children:"Save/load system"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var s=t(6540);const o={},i=s.createContext(o);function l(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);