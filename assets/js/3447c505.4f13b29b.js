"use strict";(self.webpackChunkdst_api_webdocs=self.webpackChunkdst_api_webdocs||[]).push([[3548],{1586:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"api-vanilla/getting-started/backwards-compatibility","title":"Backwards Compatibility","description":"This guide focuses on maintaining backwards compatibility in your Don\'t Starve Together mods, allowing them to work across multiple game versions. Creating mods that function correctly on both older and newer versions of the game improves user experience and reduces maintenance overhead.","source":"@site/docs/api-vanilla/getting-started/backwards-compatibility.md","sourceDirName":"api-vanilla/getting-started","slug":"/api-vanilla/getting-started/backwards-compatibility","permalink":"/dst-api-webdocs/docs/api-vanilla/getting-started/backwards-compatibility","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"id":"backwards-compatibility","title":"Backwards Compatibility","sidebar_position":9,"last_updated":"2023-07-06T00:00:00.000Z"},"sidebar":"docs","previous":{"title":"Deprecated Features and Alternatives","permalink":"/dst-api-webdocs/docs/api-vanilla/getting-started/deprecated-features"},"next":{"title":"Migration Guides","permalink":"/dst-api-webdocs/docs/api-vanilla/getting-started/migration-guides"}}');var a=i(4848),s=i(8453);const r={id:"backwards-compatibility",title:"Backwards Compatibility",sidebar_position:9,last_updated:new Date("2023-07-06T00:00:00.000Z")},l="Backwards Compatibility",o={},c=[{value:"Why Backwards Compatibility Matters",id:"why-backwards-compatibility-matters",level:2},{value:"Compatibility Challenges",id:"compatibility-challenges",level:2},{value:"API Changes",id:"api-changes",level:3},{value:"Game Behavior Changes",id:"game-behavior-changes",level:3},{value:"Compatibility Strategies",id:"compatibility-strategies",level:2},{value:"Version Detection",id:"version-detection",level:3},{value:"Feature Detection",id:"feature-detection",level:3},{value:"Abstraction Layers",id:"abstraction-layers",level:3},{value:"Fallback Implementations",id:"fallback-implementations",level:3},{value:"Conditional Features",id:"conditional-features",level:3},{value:"Common Compatibility Issues",id:"common-compatibility-issues",level:2},{value:"Global Objects",id:"global-objects",level:3},{value:"Component Access",id:"component-access",level:3},{value:"Network Synchronization",id:"network-synchronization",level:3},{value:"Event System",id:"event-system",level:3},{value:"Testing Across Versions",id:"testing-across-versions",level:2},{value:"Versioning Your Mod",id:"versioning-your-mod",level:2},{value:"Communicating Compatibility",id:"communicating-compatibility",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"backwards-compatibility",children:"Backwards Compatibility"})}),"\n",(0,a.jsx)(n.p,{children:"This guide focuses on maintaining backwards compatibility in your Don't Starve Together mods, allowing them to work across multiple game versions. Creating mods that function correctly on both older and newer versions of the game improves user experience and reduces maintenance overhead."}),"\n",(0,a.jsx)(n.h2,{id:"why-backwards-compatibility-matters",children:"Why Backwards Compatibility Matters"}),"\n",(0,a.jsx)(n.p,{children:"Maintaining backwards compatibility is important for several reasons:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"User Base"}),": Not all players update to the latest version immediately"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Server Compatibility"}),": Servers may run older versions of the game"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Mod Collections"}),": Users may have collections of mods that work together"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Reduced Maintenance"}),": Fewer version-specific branches to maintain"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"compatibility-challenges",children:"Compatibility Challenges"}),"\n",(0,a.jsx)(n.p,{children:"Several factors can affect backwards compatibility:"}),"\n",(0,a.jsx)(n.h3,{id:"api-changes",children:"API Changes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Added Features"}),": New components, functions, or properties"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Modified Features"}),": Changes to existing functionality"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Removed Features"}),": Functionality that no longer exists"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Renamed Features"}),": Same functionality with different names"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"game-behavior-changes",children:"Game Behavior Changes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Physics Changes"}),": Modifications to collision or movement"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Balance Changes"}),": Adjustments to game mechanics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"World Generation"}),": Changes to how worlds are created"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Performance Optimizations"}),": Changes that affect timing or execution order"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"compatibility-strategies",children:"Compatibility Strategies"}),"\n",(0,a.jsx)(n.h3,{id:"version-detection",children:"Version Detection"}),"\n",(0,a.jsx)(n.p,{children:"Detect the game version to adapt your mod's behavior:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local function GetGameVersion()\n    if TheSim and TheSim.GetGameVersion then\n        return TheSim:GetGameVersion()\n    end\n    return "0.0.0" -- Default for very old versions\nend\n\nlocal game_version = GetGameVersion()\n\n-- Use version to determine behavior\nlocal function IsVersionAtLeast(major, minor, revision)\n    -- Implementation depends on version format\n    -- This is a simplified example\n    local current = game_version:match("(%d+)")\n    return current ~= nil and tonumber(current) >= major\nend\n\nif IsVersionAtLeast(400000) then\n    -- Use newer API\nelse\n    -- Use older API\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"feature-detection",children:"Feature Detection"}),"\n",(0,a.jsx)(n.p,{children:"Instead of version checking, detect if specific features exist:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Check if a function exists\nif TheWorld.state ~= nil then\n    -- Use new state system\n    local is_day = TheWorld.state.isday\nelse\n    -- Use old clock system\n    local is_day = GetClock() ~= nil and GetClock():IsDay()\nend\n\n-- Check if a component method exists\nif inst.components.health ~= nil then\n    if inst.components.health.SetMaxHealth ~= nil then\n        -- Use new method\n        inst.components.health:SetMaxHealth(100)\n    else\n        -- Use old property\n        inst.components.health.maxhealth = 100\n    end\nend\n"})}),"\n",(0,a.jsx)(n.h3,{id:"abstraction-layers",children:"Abstraction Layers"}),"\n",(0,a.jsx)(n.p,{children:"Create wrapper functions that hide API differences:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Wrapper for getting the current player\nlocal function GetCurrentPlayer()\n    return ThePlayer or (GetPlayer ~= nil and GetPlayer()) or nil\nend\n\n-- Wrapper for getting the current phase\nlocal function GetCurrentPhase()\n    if TheWorld.state ~= nil then\n        return TheWorld.state.phase\n    elseif GetClock() ~= nil then\n        if GetClock():IsDay() then\n            return "day"\n        elseif GetClock():IsDusk() then\n            return "dusk"\n        else\n            return "night"\n        end\n    end\n    return "day" -- Default fallback\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"fallback-implementations",children:"Fallback Implementations"}),"\n",(0,a.jsx)(n.p,{children:"Provide alternative implementations when features are missing:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Example: Implementing a missing function\nif not TheWorld.HasTag then\n    TheWorld.HasTag = function(self, tag)\n        return self.Network ~= nil and \n               self.Network.components ~= nil and \n               self.Network.components.tags ~= nil and \n               self.Network.components.tags:HasTag(tag)\n    end\nend\n\n-- Safe function calling with fallback\nlocal function SafeCall(obj, fn_name, ...)\n    if obj ~= nil and type(obj[fn_name]) == "function" then\n        return obj[fn_name](obj, ...)\n    end\n    return nil\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"conditional-features",children:"Conditional Features"}),"\n",(0,a.jsx)(n.p,{children:"Enable or disable features based on compatibility:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"local CONFIG = {\n    -- Feature flags\n    use_new_network_api = true,\n    use_legacy_combat = false,\n    enable_advanced_features = true\n}\n\n-- Check if advanced features can be used\nlocal can_use_advanced = CONFIG.enable_advanced_features and \n                         TheWorld.state ~= nil and \n                         TheNet.GetClientTable ~= nil\n\nif can_use_advanced then\n    -- Implement advanced features\nelse\n    -- Implement basic features only\nend\n"})}),"\n",(0,a.jsx)(n.h2,{id:"common-compatibility-issues",children:"Common Compatibility Issues"}),"\n",(0,a.jsx)(n.h3,{id:"global-objects",children:"Global Objects"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Safe access to global objects\nlocal world = TheWorld or GetWorld()\nlocal player = ThePlayer or (GetPlayer ~= nil and GetPlayer())\n"})}),"\n",(0,a.jsx)(n.h3,{id:"component-access",children:"Component Access"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"-- Safe component access\nlocal function GetHealth(inst)\n    if inst == nil then return 0 end\n    \n    -- Server-side with component\n    if inst.components ~= nil and inst.components.health ~= nil then\n        return inst.components.health.currenthealth\n    end\n    \n    -- Client-side with replica\n    if inst.replica ~= nil and inst.replica.health ~= nil then\n        return inst.replica.health:GetCurrent()\n    end\n    \n    return 0\nend\n"})}),"\n",(0,a.jsx)(n.h3,{id:"network-synchronization",children:"Network Synchronization"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Compatible network variable setup\nlocal function SetupNetworking(inst)\n    -- Create network variable\n    local net_var = net_string(inst.GUID, "net_var", "net_var_dirty")\n    \n    -- Set initial value safely\n    if net_var.Set ~= nil then\n        net_var:Set("initial_value")\n    else\n        net_var.value = "initial_value"\n    end\n    \n    -- Get value safely\n    local function GetNetValue()\n        if net_var.Get ~= nil then\n            return net_var:Get()\n        else\n            return net_var.value\n        end\n    end\n    \n    inst.GetNetValue = GetNetValue\nend\n'})}),"\n",(0,a.jsx)(n.h3,{id:"event-system",children:"Event System"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'-- Compatible event handling\nlocal function SetupEvents(inst)\n    -- Handle renamed events\n    inst:ListenForEvent("cycleschanged", function(world, data)\n        -- New event in newer versions\n        OnNewDay(world, data)\n    end)\n    \n    if GetWorld ~= nil then\n        -- Old event in older versions\n        inst:ListenForEvent("daycomplete", function(world, data)\n            OnNewDay(world, data)\n        end)\n    end\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"testing-across-versions",children:"Testing Across Versions"}),"\n",(0,a.jsx)(n.p,{children:"To ensure backwards compatibility:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Maintain Test Environments"}),": Keep installations of different game versions"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Version Matrix"}),": Test your mod against a matrix of game versions"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Feature Tests"}),": Create tests for specific features that might change"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"User Reports"}),": Pay attention to user reports about version-specific issues"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"versioning-your-mod",children:"Versioning Your Mod"}),"\n",(0,a.jsx)(n.p,{children:"Consider using semantic versioning for your mod:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Major Version"}),": Incompatible API changes"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Minor Version"}),": Added functionality in a backwards-compatible manner"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Patch Version"}),": Backwards-compatible bug fixes"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example version scheme:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'ModVersion = "2.3.1"\n-- 2 = Major version (breaking changes)\n-- 3 = Minor version (new features)\n-- 1 = Patch version (bug fixes)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"communicating-compatibility",children:"Communicating Compatibility"}),"\n",(0,a.jsx)(n.p,{children:"Clearly communicate compatibility information to users:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Version Requirements"}),": Specify minimum and maximum game versions"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Known Issues"}),": Document version-specific issues"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Changelog"}),": Maintain a detailed changelog noting compatibility changes"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Documentation"}),": Provide version-specific documentation when needed"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example mod info:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'name = "My Compatible Mod"\ndescription = "Works with DST versions 400000-517850. See notes for details."\n'})}),"\n",(0,a.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,a.jsx)(n.p,{children:"Maintaining backwards compatibility requires effort but pays off in user satisfaction and reduced maintenance burden. By using feature detection, abstraction layers, and careful testing, you can create mods that work across multiple game versions."}),"\n",(0,a.jsx)(n.p,{children:"Remember that perfect backwards compatibility isn't always possible or practical. In some cases, it may be better to maintain separate versions of your mod for significantly different game versions."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(6540);const a={},s=t.createContext(a);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);