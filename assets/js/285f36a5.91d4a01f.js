"use strict";(self.webpackChunkdst_api_webdocs=self.webpackChunkdst_api_webdocs||[]).push([[43977],{1166:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"game-scripts/core-systems/fundamentals/ai-systems/stategraph","title":"Stategraph","description":"Core state machine system for managing entity behaviors and animations","source":"@site/docs/game-scripts/core-systems/fundamentals/ai-systems/stategraph.md","sourceDirName":"game-scripts/core-systems/fundamentals/ai-systems","slug":"/game-scripts/core-systems/fundamentals/ai-systems/stategraph","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/fundamentals/ai-systems/stategraph","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"stategraph","title":"Stategraph","description":"Core state machine system for managing entity behaviors and animations","sidebar_position":3,"last_updated":"2025-06-21T00:00:00.000Z","build_version":676042,"change_status":"stable"},"sidebar":"docs","previous":{"title":"Brain System","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/fundamentals/ai-systems/brain"},"next":{"title":"Actions Overview","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/fundamentals/actions/actions-overview"}}');var i=s(74848),r=s(28453);const a={id:"stategraph",title:"Stategraph",description:"Core state machine system for managing entity behaviors and animations",sidebar_position:3,last_updated:new Date("2025-06-21T00:00:00.000Z"),build_version:676042,change_status:"stable"},l="Stategraph",d={},c=[{value:"Version History",id:"version-history",level:2},{value:"Overview",id:"overview",level:2},{value:"Core Architecture",id:"core-architecture",level:2},{value:"Usage Example",id:"usage-example",level:2},{value:"Classes",id:"classes",level:2},{value:"StateGraphWrangler",id:"stategraphwrangler",level:3},{value:"Properties",id:"properties",level:4},{value:".instances",id:"instances",level:5},{value:".updaters",id:"updaters",level:5},{value:".hibernaters",id:"hibernaters",level:5},{value:".haveEvents",id:"haveevents",level:5},{value:"Methods",id:"methods",level:4},{value:"(inst)",id:"stategraphwrangler-addinstance",level:5},{value:"(inst)",id:"stategraphwrangler-removeinstance",level:5},{value:"(current_tick)",id:"stategraphwrangler-update",level:5},{value:"(inst, time_to_wait)",id:"stategraphwrangler-sleep",level:5},{value:"(inst)",id:"stategraphwrangler-hibernate",level:5},{value:"(inst)",id:"stategraphwrangler-wake",level:5},{value:"StateGraph",id:"stategraph",level:3},{value:"Constructor",id:"constructor",level:4},{value:"Properties",id:"properties-1",level:4},{value:".name",id:"name",level:5},{value:".states",id:"states",level:5},{value:".events",id:"events",level:5},{value:".actionhandlers",id:"actionhandlers",level:5},{value:".defaultstate",id:"defaultstate",level:5},{value:"StateGraphInstance",id:"stategraphinstance",level:3},{value:"Constructor",id:"constructor-1",level:4},{value:"Properties",id:"properties-2",level:4},{value:".currentstate",id:"currentstate",level:5},{value:".timeinstate",id:"timeinstate",level:5},{value:".tags",id:"tags",level:5},{value:".statemem",id:"statemem",level:5},{value:".mem",id:"mem",level:5},{value:"Methods",id:"methods-1",level:4},{value:"(statename, params)",id:"stategraphinstance-gotostate",level:5},{value:"(statename)",id:"stategraphinstance-hasstate",level:5},{value:"(event, data)",id:"stategraphinstance-pushevent",level:5},{value:"(time)",id:"stategraphinstance-settimeout",level:5},{value:"(tag)",id:"stategraphinstance-addstatetag",level:5},{value:"(tag)",id:"stategraphinstance-removestatetag",level:5},{value:"(tag)",id:"stategraphinstance-hasstatetag",level:5},{value:"(...)",id:"stategraphinstance-hasanystatetag",level:5},{value:"()",id:"stategraphinstance-gettimeinstate",level:5},{value:"(bufferedaction)",id:"stategraphinstance-startaction",level:5},{value:"()",id:"stategraphinstance-start",level:5},{value:"()",id:"stategraphinstance-stop",level:5},{value:"State",id:"state",level:3},{value:"Constructor",id:"constructor-2",level:4},{value:"Properties",id:"properties-3",level:4},{value:".name",id:"name-1",level:5},{value:".tags",id:"tags-1",level:5},{value:".onenter",id:"onenter",level:5},{value:".onexit",id:"onexit",level:5},{value:".onupdate",id:"onupdate",level:5},{value:".ontimeout",id:"ontimeout",level:5},{value:".events",id:"events-1",level:5},{value:".timeline",id:"timeline",level:5},{value:"ActionHandler",id:"actionhandler",level:3},{value:"Constructor",id:"constructor-3",level:4},{value:"EventHandler",id:"eventhandler",level:3},{value:"Constructor",id:"constructor-4",level:4},{value:"TimeEvent",id:"timeevent",level:3},{value:"Constructor",id:"constructor-5",level:4},{value:"Helper Functions",id:"helper-functions",level:2},{value:"FrameEvent(frame, fn)",id:"frameevent",level:3},{value:"SoundTimeEvent(time, sound_event)",id:"soundtimeevent",level:3},{value:"SoundFrameEvent(frame, sound_event)",id:"soundframeevent",level:3},{value:"Global Variables",id:"global-variables",level:2},{value:"SGManager",id:"sgmanager",level:3},{value:"Common State Tags",id:"common-state-tags",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"State Design",id:"state-design",level:3},{value:"Event Handling",id:"event-handling",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"Performance",id:"performance",level:3},{value:"Common Usage Patterns",id:"common-usage-patterns",level:2},{value:"Basic Animation State",id:"basic-animation-state",level:3},{value:"Timed Action State",id:"timed-action-state",level:3},{value:"Event-Driven State",id:"event-driven-state",level:3},{value:"Timeline-Based State",id:"timeline-based-state",level:3},{value:"Related Modules",id:"related-modules",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"stategraph",children:"Stategraph"})}),"\n",(0,i.jsx)(n.h2,{id:"version-history",children:"Version History"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Build Version"}),(0,i.jsx)(n.th,{children:"Change Date"}),(0,i.jsx)(n.th,{children:"Change Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"676042"}),(0,i.jsx)(n.td,{children:"2025-06-21"}),(0,i.jsx)(n.td,{children:"stable"}),(0,i.jsx)(n.td,{children:"Current version"})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Stategraph"})," module provides a comprehensive state machine system for managing entity behaviors, animations, and logic flow in Don't Starve Together. It consists of a hierarchical system where StateGraphs contain States, which define specific behaviors and can handle events, timelines, and transitions."]}),"\n",(0,i.jsx)(n.p,{children:"The system is built around several core classes that work together to provide smooth state transitions, event handling, and timeline-based behavior execution."}),"\n",(0,i.jsx)(n.h2,{id:"core-architecture",children:"Core Architecture"}),"\n",(0,i.jsx)(n.p,{children:"The stategraph system is organized around these main components:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"StateGraphWrangler"}),": Global manager for all stategraph instances"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"StateGraph"}),": Template defining states, events, and action handlers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"StateGraphInstance"}),": Runtime instance of a stategraph attached to an entity"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"State"}),": Individual behavior state with enter/exit/update functions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ActionHandler"}),": Maps game actions to state transitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EventHandler"}),": Handles events within states"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"TimeEvent"}),": Timeline-based events within states"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'-- Basic stategraph creation\nlocal states = {\n    State{\n        name = "idle",\n        tags = {"idle"},\n        onenter = function(inst)\n            inst.AnimState:PlayAnimation("idle")\n        end,\n        events = {\n            EventHandler("attacked", function(inst, data)\n                inst.sg:GoToState("hit")\n            end),\n        },\n    },\n    \n    State{\n        name = "hit",\n        tags = {"busy"},\n        onenter = function(inst)\n            inst.AnimState:PlayAnimation("hit")\n        end,\n        timeline = {\n            TimeEvent(0.5, function(inst)\n                inst.sg:GoToState("idle")\n            end),\n        },\n    },\n}\n\nlocal events = {\n    EventHandler("death", function(inst)\n        inst.sg:GoToState("death")\n    end),\n}\n\nlocal actionhandlers = {\n    ActionHandler(ACTIONS.ATTACK, "attack"),\n}\n\nreturn StateGraph("example", states, events, "idle", actionhandlers)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"classes",children:"Classes"}),"\n",(0,i.jsx)(n.h3,{id:"stategraphwrangler",children:"StateGraphWrangler"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nGlobal manager that handles the lifecycle and updates of all stategraph instances. Manages hibernation, sleeping, event processing, and update scheduling."]}),"\n",(0,i.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(n.h5,{id:"instances",children:".instances"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Map of all registered stategraph instances to their current update lists."]}),"\n",(0,i.jsx)(n.h5,{id:"updaters",children:".updaters"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," List of stategraph instances that need updating this frame."]}),"\n",(0,i.jsx)(n.h5,{id:"hibernaters",children:".hibernaters"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," List of hibernated stategraph instances that are not actively updating."]}),"\n",(0,i.jsx)(n.h5,{id:"haveevents",children:".haveEvents"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," List of stategraph instances that have pending events to process."]}),"\n",(0,i.jsx)(n.h4,{id:"methods",children:"Methods"}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-addinstance",children:[":AddInstance","(inst)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nRegisters a stategraph instance with the manager and adds it to the updaters list."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (StateGraphInstance): The stategraph instance to register"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"SGManager:AddInstance(entity.sg)\n"})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-removeinstance",children:[":RemoveInstance","(inst)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nUnregisters a stategraph instance from the manager and cleans up all references."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (StateGraphInstance): The stategraph instance to unregister"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"SGManager:RemoveInstance(entity.sg)\n"})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-update",children:[":Update","(current_tick)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nMain update function called each frame to process all active stategraph instances."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"current_tick"})," (number): Current game tick"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-sleep",children:[":Sleep","(inst, time_to_wait)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nPuts a stategraph instance to sleep for a specified duration."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (StateGraphInstance): The stategraph instance to sleep"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"time_to_wait"})," (number): Time in seconds to sleep"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-hibernate",children:[":Hibernate","(inst)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nHibernates a stategraph instance, removing it from active updates."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (StateGraphInstance): The stategraph instance to hibernate"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphwrangler-wake",children:[":Wake","(inst)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nWakes a hibernated stategraph instance and returns it to active updates."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (StateGraphInstance): The stategraph instance to wake"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"stategraph",children:"StateGraph"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nTemplate class that defines the structure of a state machine, including its states, events, and action handlers."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"StateGraph(name, states, events, defaultstate, actionhandlers)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"})," (string): Unique identifier for this stategraph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"states"})," (table): Array of State objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"events"})," (table): Array of EventHandler objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"defaultstate"})," (string): Name of the initial state"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"actionhandlers"})," (table): Array of ActionHandler objects"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"properties-1",children:"Properties"}),"\n",(0,i.jsx)(n.h5,{id:"name",children:".name"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"string"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Unique identifier for this stategraph."]}),"\n",(0,i.jsx)(n.h5,{id:"states",children:".states"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Map of state name to State object."]}),"\n",(0,i.jsx)(n.h5,{id:"events",children:".events"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Map of event name to EventHandler object."]}),"\n",(0,i.jsx)(n.h5,{id:"actionhandlers",children:".actionhandlers"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Map of action to ActionHandler object."]}),"\n",(0,i.jsx)(n.h5,{id:"defaultstate",children:".defaultstate"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"string"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Name of the default state to enter when starting."]}),"\n",(0,i.jsx)(n.h3,{id:"stategraphinstance",children:"StateGraphInstance"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nRuntime instance of a StateGraph attached to a specific entity. Manages the current state, handles events, and processes timeline events."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor-1",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"StateGraphInstance(stategraph, inst)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"stategraph"})," (StateGraph): The template stategraph to instantiate"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inst"})," (Entity): The entity this instance is attached to"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"properties-2",children:"Properties"}),"\n",(0,i.jsx)(n.h5,{id:"currentstate",children:".currentstate"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"State"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Currently active state object."]}),"\n",(0,i.jsx)(n.h5,{id:"timeinstate",children:".timeinstate"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"number"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Time in seconds spent in the current state."]}),"\n",(0,i.jsx)(n.h5,{id:"tags",children:".tags"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Set of tags from the current state."]}),"\n",(0,i.jsx)(n.h5,{id:"statemem",children:".statemem"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Memory table that persists for the duration of the current state."]}),"\n",(0,i.jsx)(n.h5,{id:"mem",children:".mem"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Memory table that persists across state changes."]}),"\n",(0,i.jsx)(n.h4,{id:"methods-1",children:"Methods"}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-gotostate",children:[":GoToState","(statename, params)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nTransitions to a new state, calling onexit on the current state and onenter on the new state."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"statename"})," (string): Name of the state to transition to"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"params"})," (any): Optional parameters passed to the new state's onenter function"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'inst.sg:GoToState("attack", {target = target})\n'})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-hasstate",children:[":HasState","(statename)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nChecks if a state with the given name exists in this stategraph."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"statename"})," (string): Name of the state to check"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(boolean): True if the state exists"}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-pushevent",children:[":PushEvent","(event, data)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nQueues an event to be processed during the next event handling phase."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"event"})," (string): Name of the event"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"data"})," (table): Optional event data"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'inst.sg:PushEvent("attacked", {attacker = attacker, damage = 10})\n'})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-settimeout",children:[":SetTimeout","(time)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nSets a timeout for the current state. When the timeout expires, the state's ontimeout function is called."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"time"})," (number): Timeout duration in seconds"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"inst.sg:SetTimeout(2.0) -- Timeout after 2 seconds\n"})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-addstatetag",children:[":AddStateTag","(tag)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nAdds a tag to the current state and optionally to the entity."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tag"})," (string): Tag to add"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-removestatetag",children:[":RemoveStateTag","(tag)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nRemoves a tag from the current state and optionally from the entity."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tag"})," (string): Tag to remove"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-hasstatetag",children:[":HasStateTag","(tag)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nChecks if the current state has a specific tag."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tag"})," (string): Tag to check"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(boolean): True if the tag is present"}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-hasanystatetag",children:[":HasAnyStateTag","(...)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nChecks if the current state has any of the specified tags."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"..."})," (string): Tags to check for"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(boolean): True if any of the tags are present"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'if inst.sg:HasAnyStateTag("busy", "working") then\n    -- Entity is busy\nend\n'})}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-gettimeinstate",children:[":GetTimeInState","()"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nReturns the time spent in the current state."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(number): Time in seconds"}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-startaction",children:[":StartAction","(bufferedaction)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nAttempts to start an action by finding an appropriate action handler."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bufferedaction"})," (BufferedAction): The action to start"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(boolean): True if an action handler was found and executed"}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-start",children:[":Start","()"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nStarts the stategraph instance and registers it with the global manager."]}),"\n",(0,i.jsxs)(n.h5,{id:"stategraphinstance-stop",children:[":Stop","()"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nStops the stategraph instance and unregisters it from the global manager."]}),"\n",(0,i.jsx)(n.h3,{id:"state",children:"State"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nDefines a single state within a stategraph, including its behavior, events, timeline, and tags."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor-2",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'State{\n    name = "statename",\n    tags = {"tag1", "tag2"},\n    onenter = function(inst, params) end,\n    onexit = function(inst) end,\n    onupdate = function(inst, dt) end,\n    ontimeout = function(inst) end,\n    events = {EventHandler(...)},\n    timeline = {TimeEvent(...)}\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"properties-3",children:"Properties"}),"\n",(0,i.jsx)(n.h5,{id:"name-1",children:".name"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"string"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Unique name identifying this state within its stategraph."]}),"\n",(0,i.jsx)(n.h5,{id:"tags-1",children:".tags"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Set of tags that define this state's properties."]}),"\n",(0,i.jsx)(n.h5,{id:"onenter",children:".onenter"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"function"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Function called when entering this state."]}),"\n",(0,i.jsx)(n.h5,{id:"onexit",children:".onexit"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"function"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Function called when leaving this state."]}),"\n",(0,i.jsx)(n.h5,{id:"onupdate",children:".onupdate"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"function"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Function called every frame while in this state."]}),"\n",(0,i.jsx)(n.h5,{id:"ontimeout",children:".ontimeout"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"function"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Function called when the state timeout expires."]}),"\n",(0,i.jsx)(n.h5,{id:"events-1",children:".events"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Map of event handlers specific to this state."]}),"\n",(0,i.jsx)(n.h5,{id:"timeline",children:".timeline"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"table"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Array of TimeEvent objects executed at specific times."]}),"\n",(0,i.jsx)(n.h3,{id:"actionhandler",children:"ActionHandler"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nMaps game actions to state transitions with optional conditions."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor-3",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"ActionHandler(action, state, condition)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"action"})," (Action): The action that triggers this handler"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state"})," (string|function): Target state name or function returning state name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"condition"})," (function): Optional condition function"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'ActionHandler(ACTIONS.CHOP, "chopping", function(inst)\n    return inst.components.worker ~= nil\nend)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"eventhandler",children:"EventHandler"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nHandles specific events within states or globally across the stategraph."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor-4",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"EventHandler(name, fn)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"})," (string): Name of the event to handle"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fn"})," (function): Function to call when the event occurs"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'EventHandler("attacked", function(inst, data)\n    inst.sg:GoToState("hit")\nend)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"timeevent",children:"TimeEvent"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nExecutes a function at a specific time within a state's timeline."]}),"\n",(0,i.jsx)(n.h4,{id:"constructor-5",children:"Constructor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"TimeEvent(time, fn)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"time"})," (number): Time in seconds when to execute the function"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fn"})," (function): Function to execute"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'TimeEvent(0.5, function(inst)\n    inst.SoundEmitter:PlaySound("dontstarve/creatures/attack")\nend)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"helper-functions",children:"Helper Functions"}),"\n",(0,i.jsx)(n.h3,{id:"frameevent",children:"FrameEvent(frame, fn)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nCreates a TimeEvent based on frame count instead of seconds."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"frame"})," (number): Frame number when to execute"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fn"})," (function): Function to execute"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(TimeEvent): TimeEvent object"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'FrameEvent(10, function(inst)\n    inst.sg:GoToState("idle")\nend)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"soundtimeevent",children:"SoundTimeEvent(time, sound_event)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nCreates a TimeEvent that plays a sound at a specific time."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"time"})," (number): Time in seconds when to play the sound"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sound_event"})," (string): Sound event path"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(TimeEvent): TimeEvent object that plays the sound"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'SoundTimeEvent(0.3, "dontstarve/creatures/footstep")\n'})}),"\n",(0,i.jsx)(n.h3,{id:"soundframeevent",children:"SoundFrameEvent(frame, sound_event)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nCreates a TimeEvent that plays a sound at a specific frame."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"frame"})," (number): Frame number when to play the sound"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sound_event"})," (string): Sound event path"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"(TimeEvent): TimeEvent object that plays the sound"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'SoundFrameEvent(5, "dontstarve/creatures/attack")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"global-variables",children:"Global Variables"}),"\n",(0,i.jsx)(n.h3,{id:"sgmanager",children:"SGManager"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Type:"})," ",(0,i.jsx)(n.code,{children:"StateGraphWrangler"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," ",(0,i.jsx)(n.code,{children:"stable"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),"\nGlobal instance of StateGraphWrangler that manages all stategraph instances in the game."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"-- Add instance to global manager\nSGManager:AddInstance(inst.sg)\n\n-- Remove instance from global manager\nSGManager:RemoveInstance(inst.sg)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-state-tags",children:"Common State Tags"}),"\n",(0,i.jsx)(n.p,{children:"The following tags have special meaning when used in states:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Tag"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"idle"})}),(0,i.jsx)(n.td,{children:"Entity is idle and available for interactions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"busy"})}),(0,i.jsx)(n.td,{children:"Entity is busy and should not be interrupted"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"moving"})}),(0,i.jsx)(n.td,{children:"Entity is in motion"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"attack"})}),(0,i.jsx)(n.td,{children:"Entity is performing an attack"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"working"})}),(0,i.jsx)(n.td,{children:"Entity is performing work"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sleeping"})}),(0,i.jsx)(n.td,{children:"Entity is sleeping"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"invisible"})}),(0,i.jsx)(n.td,{children:"Entity should be treated as invisible"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"noattack"})}),(0,i.jsx)(n.td,{children:"Entity cannot be attacked"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"nopredict"})}),(0,i.jsx)(n.td,{children:"State should not use client prediction"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"autopredict"})}),(0,i.jsx)(n.td,{children:"State should automatically use prediction"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"state-design",children:"State Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Keep states focused on a single behavior or animation"}),"\n",(0,i.jsx)(n.li,{children:"Use descriptive state names that clearly indicate purpose"}),"\n",(0,i.jsx)(n.li,{children:"Include appropriate tags to communicate state properties"}),"\n",(0,i.jsx)(n.li,{children:"Use timeline events for precise timing of effects"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"event-handling",children:"Event Handling"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Handle events at the most appropriate level (state vs stategraph)"}),"\n",(0,i.jsx)(n.li,{children:"Use event data to pass relevant information"}),"\n",(0,i.jsx)(n.li,{children:"Consider using PushEvent for delayed event processing"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"statemem"})," for data that should reset between states"]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"mem"})," for data that should persist across states"]}),"\n",(0,i.jsx)(n.li,{children:"Clear unused memory to prevent leaks"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Minimize onupdate functions when possible"}),"\n",(0,i.jsx)(n.li,{children:"Use timeline events instead of constant polling"}),"\n",(0,i.jsx)(n.li,{children:"Hibernate stategraphs when entities are not active"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"common-usage-patterns",children:"Common Usage Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"basic-animation-state",children:"Basic Animation State"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'State{\n    name = "walk",\n    tags = {"moving"},\n    onenter = function(inst)\n        inst.AnimState:PlayAnimation("walk_loop", true)\n    end,\n    onexit = function(inst)\n        inst.AnimState:Stop()\n    end,\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"timed-action-state",children:"Timed Action State"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'State{\n    name = "work",\n    tags = {"busy", "working"},\n    onenter = function(inst)\n        inst.AnimState:PlayAnimation("work")\n        inst.sg:SetTimeout(2.0)\n    end,\n    ontimeout = function(inst)\n        inst.sg:GoToState("idle")\n    end,\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"event-driven-state",children:"Event-Driven State"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'State{\n    name = "vulnerable",\n    tags = {"idle"},\n    events = {\n        EventHandler("attacked", function(inst, data)\n            inst.sg:GoToState("hit", data)\n        end),\n    },\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"timeline-based-state",children:"Timeline-Based State"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'State{\n    name = "attack",\n    tags = {"attack", "busy"},\n    onenter = function(inst)\n        inst.AnimState:PlayAnimation("attack")\n    end,\n    timeline = {\n        TimeEvent(0.2, function(inst)\n            inst:PerformBufferedAction()\n        end),\n        TimeEvent(0.8, function(inst)\n            inst.sg:GoToState("idle")\n        end),\n    },\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"related-modules",children:"Related Modules"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./animstate.md",children:"AnimState"}),": Animation control system used by stategraphs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./bufferedaction.md",children:"BufferedAction"}),": Action system integrated with stategraphs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./events.md",children:"Events"}),": Event system used for communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./entityscript.md",children:"EntityScript"}),": Base entity functionality"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(96540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);