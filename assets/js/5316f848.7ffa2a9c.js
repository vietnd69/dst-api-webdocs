"use strict";(self.webpackChunkdst_api_webdocs=self.webpackChunkdst_api_webdocs||[]).push([[17768],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(96540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}},52510:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"game-scripts/core-systems/world-systems/generation/worldsettingsutil","title":"World Settings Util","description":"Utility functions for managing external timers and world settings integration with game components","source":"@site/docs/game-scripts/core-systems/world-systems/generation/worldsettingsutil.md","sourceDirName":"game-scripts/core-systems/world-systems/generation","slug":"/game-scripts/core-systems/world-systems/generation/worldsettingsutil","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/world-systems/generation/worldsettingsutil","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"worldsettingsutil","title":"World Settings Util","description":"Utility functions for managing external timers and world settings integration with game components","sidebar_position":2,"last_updated":"2025-06-21T00:00:00.000Z","build_version":676042,"change_status":"stable"},"sidebar":"docs","previous":{"title":"RegrowthUtil","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/world-systems/generation/regrowthutil"},"next":{"title":"World Settings Overrides","permalink":"/dst-api-webdocs/docs/game-scripts/core-systems/world-systems/generation/worldsettings_overrides"}}');var r=i(74848),t=i(28453);const l={id:"worldsettingsutil",title:"World Settings Util",description:"Utility functions for managing external timers and world settings integration with game components",sidebar_position:2,last_updated:new Date("2025-06-21T00:00:00.000Z"),build_version:676042,change_status:"stable"},a="World Settings Util",d={},o=[{value:"Version History",id:"version-history",level:2},{value:"Overview",id:"overview",level:2},{value:"Usage Example",id:"usage-example",level:2},{value:"Timer Function Generators",id:"timer-function-generators",level:2},{value:"MakePauseTimerFunction(timername)",id:"make-pause-timer-function",level:3},{value:"MakeResumeTimerFunction(timername)",id:"make-resume-timer-function",level:3},{value:"MakeStartTimerFunction(timername)",id:"make-start-timer-function",level:3},{value:"MakeStopTimerFunction(timername)",id:"make-stop-timer-function",level:3},{value:"ChildSpawner Integration",id:"childspawner-integration",level:2},{value:"WorldSettings_ChildSpawner_SpawnPeriod(inst, spawnperiod, enabled)",id:"worldsettings-childspawner-spawnperiod",level:3},{value:"WorldSettings_ChildSpawner_RegenPeriod(inst, regenperiod, enabled)",id:"worldsettings-childspawner-regenperiod",level:3},{value:"WorldSettings_ChildSpawner_PreLoad(inst, data, spawnperiod_max, regenperiod_max)",id:"worldsettings-childspawner-preload",level:3},{value:"Spawner Integration",id:"spawner-integration",level:2},{value:"WorldSettings_Spawner_SpawnDelay(inst, startdelay, enabled)",id:"worldsettings-spawner-spawndelay",level:3},{value:"WorldSettings_Spawner_PreLoad(inst, data, maxstartdelay)",id:"worldsettings-spawner-preload",level:3},{value:"Pickable Integration",id:"pickable-integration",level:2},{value:"WorldSettings_Pickable_RegenTime(inst, regentime, enabled)",id:"worldsettings-pickable-regentime",level:3},{value:"WorldSettings_Pickable_PreLoad(inst, data, maxregentime)",id:"worldsettings-pickable-preload",level:3},{value:"Timer Migration and Loading",id:"timer-migration-and-loading",level:2},{value:"WorldSettings_Timer_PreLoad(inst, data, timername, maxtimeleft)",id:"worldsettings-timer-preload",level:3},{value:"WorldSettings_Timer_PreLoad_Fix(inst, data, timername, maxmultiplier)",id:"worldsettings-timer-preload-fix",level:3},{value:"Timer Event Handlers",id:"timer-event-handlers",level:2},{value:"Timer Finished Callbacks",id:"timer-finished-callbacks",level:3},{value:"On_ChildSpawner_SpawnPeriod_TimerFinished(inst)",id:"on-childspawner-spawnperiod-timerfinished",level:4},{value:"On_ChildSpawner_RegenPeriod_TimerFinished(inst)",id:"on-childspawner-regenperiod-timerfinished",level:4},{value:"On_Spawner_StartDelay_TimerFinished(inst)",id:"on-spawner-startdelay-timerfinished",level:4},{value:"On_Pickable_RegenTime_TimerFinished(inst)",id:"on-pickable-regentime-timerfinished",level:4},{value:"Constants",id:"constants",level:2},{value:"Timer Names",id:"timer-names",level:3},{value:"Integration Benefits",id:"integration-benefits",level:2},{value:"Centralized Timer Management",id:"centralized-timer-management",level:3},{value:"World Settings Compatibility",id:"world-settings-compatibility",level:3},{value:"Related Modules",id:"related-modules",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"world-settings-util",children:"World Settings Util"})}),"\n",(0,r.jsx)(n.h2,{id:"version-history",children:"Version History"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Build Version"}),(0,r.jsx)(n.th,{children:"Change Date"}),(0,r.jsx)(n.th,{children:"Change Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"676042"}),(0,r.jsx)(n.td,{children:"2025-06-21"}),(0,r.jsx)(n.td,{children:"stable"}),(0,r.jsx)(n.td,{children:"Current version"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"worldsettingsutil"})," module provides utility functions for integrating world settings with component-based game systems. It enables components to use external timers managed by the world settings system instead of their internal timers, allowing for global configuration of spawning, regeneration, and other time-based mechanics."]}),"\n",(0,r.jsx)(n.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- Set up external timer for a childspawner component\nlocal worldsettingsutil = require("worldsettingsutil")\n\n-- Configure spawn period timer\nworldsettingsutil.WorldSettings_ChildSpawner_SpawnPeriod(inst, 20, true)\n\n-- Configure regeneration timer  \nworldsettingsutil.WorldSettings_ChildSpawner_RegenPeriod(inst, 30, true)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"timer-function-generators",children:"Timer Function Generators"}),"\n",(0,r.jsx)(n.h3,{id:"make-pause-timer-function",children:"MakePauseTimerFunction(timername)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nCreates a function that pauses a named timer on an entity's worldsettingstimer component."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to pause"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"(function): Function that accepts an entity instance and pauses the timer"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- Create a pause function for a custom timer\nlocal PauseCustomTimer = MakePauseTimerFunction("custom_timer")\n\n-- Use the function to pause the timer\nPauseCustomTimer(inst)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"make-resume-timer-function",children:"MakeResumeTimerFunction(timername)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nCreates a function that resumes a named timer on an entity's worldsettingstimer component."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to resume"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"(function): Function that accepts an entity instance and resumes the timer"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"make-start-timer-function",children:"MakeStartTimerFunction(timername)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nCreates a function that starts/restarts a named timer with a specified delay."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to start"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"(function): Function that accepts an entity instance and delay, then starts the timer"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- Create a start function for spawn timer\nlocal StartSpawnTimer = MakeStartTimerFunction("spawn_timer")\n\n-- Start timer with 10 second delay\nStartSpawnTimer(inst, 10)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"make-stop-timer-function",children:"MakeStopTimerFunction(timername)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nCreates a function that stops a named timer on an entity's worldsettingstimer component."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to stop"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"(function): Function that accepts an entity instance and stops the timer"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"childspawner-integration",children:"ChildSpawner Integration"}),"\n",(0,r.jsx)(n.p,{children:"The ChildSpawner component can use external timers for spawn period and regeneration period management."}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-childspawner-spawnperiod",children:"WorldSettings_ChildSpawner_SpawnPeriod(inst, spawnperiod, enabled)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nConfigures a ChildSpawner component to use an external timer for spawn period management instead of its internal timer."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity with ChildSpawner component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spawnperiod"})," (number): Time between spawn attempts in seconds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"})," (boolean): Whether the timer should be enabled initially"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies component behavior)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Set up spawn period timer for a spider den\nWorldSettings_ChildSpawner_SpawnPeriod(inst, 15, true)\n\n-- The ChildSpawner will now use external timing\nprint(inst.components.childspawner.useexternaltimer) -- true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Integration Details:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Sets ",(0,r.jsx)(n.code,{children:"childspawner.useexternaltimer = true"})]}),"\n",(0,r.jsx)(n.li,{children:"Assigns timer control functions to childspawner"}),"\n",(0,r.jsx)(n.li,{children:"Creates and starts the external timer"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-childspawner-regenperiod",children:"WorldSettings_ChildSpawner_RegenPeriod(inst, regenperiod, enabled)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nConfigures a ChildSpawner component to use an external timer for regeneration period management."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity with ChildSpawner component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"regenperiod"})," (number): Time between regeneration attempts in seconds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"})," (boolean): Whether the timer should be enabled initially"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies component behavior)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Set up regeneration timer for a hound mound\nWorldSettings_ChildSpawner_RegenPeriod(inst, 60, true)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-childspawner-preload",children:"WorldSettings_ChildSpawner_PreLoad(inst, data, spawnperiod_max, regenperiod_max)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nPrepares ChildSpawner save data for external timer migration during world loading. Converts legacy childspawner timer data to worldsettingstimer format with normalized time values."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity being loaded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (table): Save data for the entity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spawnperiod_max"})," (number): Maximum spawn period for normalization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"regenperiod_max"})," (number): Maximum regen period for normalization"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies save data)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation Details:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Actual implementation from source code\nfunction WorldSettings_ChildSpawner_PreLoad(inst, data, spawnperiod_max, regenperiod_max)\n    if data and data.childspawner and not data.worldsettingstimer then\n        data.worldsettingstimer = { timers = {} }\n        data.worldsettingstimer.timers[CHILDSPAWNER_SPAWNPERIOD_TIMERNAME] = {\n            timeleft = math.min(data.childspawner.timetonextspawn, spawnperiod_max) / spawnperiod_max,\n            paused = data.childspawner.spawning,\n            initial_time = 0,\n        }\n        data.worldsettingstimer.timers[CHILDSPAWNER_REGENPERIOD_TIMERNAME] = {\n            timeleft = math.min(data.childspawner.timetonextregen, regenperiod_max) / regenperiod_max,\n            paused = data.childspawner.regening,\n            initial_time = 0,\n        }\n    end\nend\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Timer Name Constants:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- Defined timer names used by the system\nlocal CHILDSPAWNER_SPAWNPERIOD_TIMERNAME = "ChildSpawner_SpawnPeriod"\nlocal CHILDSPAWNER_REGENPERIOD_TIMERNAME = "ChildSpawner_RegenPeriod"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Migration Logic:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Condition Check"}),": Only migrates if legacy data exists and worldsettingstimer doesn't"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Normalization"}),": Converts absolute time values to relative (0-1) scale"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"State Preservation"}),": Maintains paused state from original timer"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Initial Time"}),": Sets to 0 for normalized timers"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"spawner-integration",children:"Spawner Integration"}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-spawner-spawndelay",children:"WorldSettings_Spawner_SpawnDelay(inst, startdelay, enabled)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nConfigures a Spawner component to use external timer for spawn delay management."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity with Spawner component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"startdelay"})," (number): Initial spawn delay in seconds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"})," (boolean): Whether the timer should be enabled initially"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies component behavior)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Set up external spawn delay for a spawner\nWorldSettings_Spawner_SpawnDelay(inst, 30, true)\n\n-- Spawner will now use external timing\nprint(inst.components.spawner.useexternaltimer) -- true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Integration Functions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spawner.starttimerfn"}),": Function to start the delay timer"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spawner.stoptimerfn"}),": Function to stop the delay timer"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spawner.timertestfn"}),": Function to check if timer exists"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-spawner-preload",children:"WorldSettings_Spawner_PreLoad(inst, data, maxstartdelay)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nMigrates Spawner save data to external timer format during world loading."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity being loaded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (table): Save data for the entity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"maxstartdelay"})," (number): Maximum start delay for normalization"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies save data)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"pickable-integration",children:"Pickable Integration"}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-pickable-regentime",children:"WorldSettings_Pickable_RegenTime(inst, regentime, enabled)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nConfigures a Pickable component to use external timer for regeneration timing."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity with Pickable component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"regentime"})," (number): Time for regeneration in seconds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"})," (boolean): Whether the timer should be enabled initially"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies component behavior)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Set up external regen timer for a berry bush\nWorldSettings_Pickable_RegenTime(inst, 180, true)\n\n-- Pickable will now use external timing\nprint(inst.components.pickable.useexternaltimer) -- true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Integration Functions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"-- Functions assigned to pickable component\npickable.startregentimer    -- Start regeneration timer\npickable.stopregentimer     -- Stop regeneration timer\npickable.pauseregentimer    -- Pause regeneration timer\npickable.resumeregentimer   -- Resume regeneration timer\npickable.getregentimertime  -- Get remaining time\npickable.setregentimertime  -- Set remaining time\npickable.regentimerexists   -- Check if timer exists\n"})}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-pickable-preload",children:"WorldSettings_Pickable_PreLoad(inst, data, maxregentime)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nMigrates Pickable save data to external timer format during world loading."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity being loaded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (table): Save data for the entity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"maxregentime"})," (number): Maximum regeneration time for normalization"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies save data)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"timer-migration-and-loading",children:"Timer Migration and Loading"}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-timer-preload",children:"WorldSettings_Timer_PreLoad(inst, data, timername, maxtimeleft)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nGeneric function for migrating timer component data to worldsettingstimer format."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity being loaded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (table): Save data for the entity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to migrate"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"maxtimeleft"})," (number): Maximum time for normalization (optional)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies save data)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- Migrate a custom timer during preload\nWorldSettings_Timer_PreLoad(inst, data, "custom_timer", 100)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"worldsettings-timer-preload-fix",children:"WorldSettings_Timer_PreLoad_Fix(inst, data, timername, maxmultiplier)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nFixes timer data by applying a maximum multiplier constraint to prevent extreme values."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inst"})," (Entity): Entity being loaded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data"})," (table): Save data for the entity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timername"})," (string): Name of the timer to fix"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"maxmultiplier"})," (number): Maximum multiplier to apply"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"None (modifies save data)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"timer-event-handlers",children:"Timer Event Handlers"}),"\n",(0,r.jsx)(n.h3,{id:"timer-finished-callbacks",children:"Timer Finished Callbacks"}),"\n",(0,r.jsx)(n.p,{children:"The module defines several timer finished callback functions that handle component-specific logic when external timers complete."}),"\n",(0,r.jsx)(n.h4,{id:"on-childspawner-spawnperiod-timerfinished",children:"On_ChildSpawner_SpawnPeriod_TimerFinished(inst)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nHandles spawn period timer completion for ChildSpawner components. Automatically restarts the timer and attempts spawning based on current component state."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local function On_ChildSpawner_SpawnPeriod_TimerFinished(inst)\n    local childspawner = inst.components.childspawner\n\n    if childspawner then\n        local dospawn = childspawner.spawning and not childspawner.queued_spawn and childspawner.childreninside > 0\n        inst.components.worldsettingstimer:StartTimer(CHILDSPAWNER_SPAWNPERIOD_TIMERNAME, childspawner:GetTimeToNextSpawn(), not dospawn)\n        if dospawn then\n            if childspawner:CanSpawnOffscreenOrAwake() then\n                childspawner:SpawnChild()\n            else\n                childspawner:QueueSpawnChild()\n            end\n        end\n    end\nend\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logic Flow:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Component Check"}),": Verifies childspawner component exists"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spawn Condition"}),": Checks spawning state, queue status, and available children"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timer Restart"}),": Always restarts timer with next spawn interval"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timer State"}),": Pauses timer if spawn conditions aren't met"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spawn Attempt"}),": Spawns immediately or queues based on visibility/sleep state"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"on-childspawner-regenperiod-timerfinished",children:"On_ChildSpawner_RegenPeriod_TimerFinished(inst)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nHandles regeneration period timer completion for ChildSpawner components. Manages child regeneration and emergency capacity checking."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local function On_ChildSpawner_RegenPeriod_TimerFinished(inst)\n    local childspawner = inst.components.childspawner\n\n    if childspawner then\n        local doregen = childspawner.regening and not (childspawner:IsFull() and childspawner:IsEmergencyFull())\n        inst.components.worldsettingstimer:StartTimer(CHILDSPAWNER_REGENPERIOD_TIMERNAME, childspawner:GetTimeToNextRegen(), not doregen)\n        if doregen then\n            childspawner:DoRegen()\n        end\n    end\nend\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logic Flow:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Component Check"}),": Verifies childspawner component exists"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regen Condition"}),": Checks regening state and capacity (both normal and emergency)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timer Restart"}),": Always restarts timer with next regen interval"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timer State"}),": Pauses timer if regen conditions aren't met (full capacity)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regen Execution"}),": Calls DoRegen() to increase child count if conditions allow"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"on-spawner-startdelay-timerfinished",children:"On_Spawner_StartDelay_TimerFinished(inst)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nHandles spawn delay timer completion for Spawner components."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logic Flow:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Set external timer finished flag"}),"\n",(0,r.jsx)(n.li,{children:"Attempt spawn if entity is asleep or spawn off-screen is enabled"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"on-pickable-regentime-timerfinished",children:"On_Pickable_RegenTime_TimerFinished(inst)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),"\nHandles regeneration timer completion for Pickable components."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logic Flow:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Trigger component regeneration"}),"\n",(0,r.jsx)(n.li,{children:"Reset pickable state to ready"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"constants",children:"Constants"}),"\n",(0,r.jsx)(n.h3,{id:"timer-names",children:"Timer Names"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," ",(0,r.jsx)(n.code,{children:"stable"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"})," Predefined timer names used by the system."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'-- ChildSpawner timer names\nCHILDSPAWNER_SPAWNPERIOD_TIMERNAME = "ChildSpawner_SpawnPeriod"\nCHILDSPAWNER_REGENPERIOD_TIMERNAME = "ChildSpawner_RegenPeriod"\n\n-- Spawner timer names\nSPAWNER_STARTDELAY_TIMERNAME = "Spawner_SpawnDelay"\n\n-- Pickable timer names\nPICKABLE_REGENTIME_TIMERNAME = "Pickable_RegenTime"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"integration-benefits",children:"Integration Benefits"}),"\n",(0,r.jsx)(n.h3,{id:"centralized-timer-management",children:"Centralized Timer Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Global Control"}),": All timers can be managed through world settings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistent Scaling"}),": Uniform difficulty scaling across components"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Save Migration"}),": Automatic conversion of legacy save data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),": Reduced timer overhead through centralization"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"world-settings-compatibility",children:"World Settings Compatibility"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dynamic Adjustment"}),": Timers can be modified at runtime"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Difficulty Scaling"}),": Integration with world difficulty systems"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Integration"}),": Timer changes trigger appropriate world events"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Persistence"}),": Timer state is properly saved and loaded"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-modules",children:"Related Modules"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/dst-api-webdocs/docs/game-scripts/core-systems/world-systems/generation/worldsettings_overrides",children:"World Settings Overrides"}),": Uses these utilities for component timer configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../components/worldsettingstimer.md",children:"World Settings Timer Component"}),": The component that manages external timers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../components/childspawner.md",children:"Child Spawner Component"}),": Component that can use external timers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../components/spawner.md",children:"Spawner Component"}),": Component that can use external timers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../components/pickable.md",children:"Pickable Component"}),": Component that can use external timers"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);